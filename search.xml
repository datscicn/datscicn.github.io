<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>任务调度与报表系统—操作说明手册</title>
    <url>/2020/05/26/ren-wu-diao-du-yu-bao-biao-xi-tong-cao-zuo-shuo-ming-shou-ce/</url>
    <content><![CDATA[<h1 id="1-系统功能简介"><a href="#1-系统功能简介" class="headerlink" title="1 系统功能简介"></a>1 系统功能简介</h1><h2 id="1-1-任务调度系统"><a href="#1-1-任务调度系统" class="headerlink" title="1.1 任务调度系统"></a>1.1 任务调度系统</h2><a id="more"></a>
<h3 id="1-1-1-简介"><a href="#1-1-1-简介" class="headerlink" title="1.1.1 简介"></a>1.1.1 简介</h3><p>不同组别中间表任务可配置成不同工作域，不同域之间独立运行、独立调度</p>
<h3 id="1-1-2-工作目录"><a href="#1-1-2-工作目录" class="headerlink" title="1.1.2 工作目录"></a>1.1.2 工作目录</h3><ul>
<li>本机: /Users/zhangqiang/DATSCI/数据实验室/数据报表  </li>
<li>服务器: /home/mission<h3 id="1-1-3-文件说明"><a href="#1-1-3-文件说明" class="headerlink" title="1.1.3 文件说明"></a>1.1.3 文件说明</h3></li>
<li><code>table_mission_域名.py</code> 该域内的任务调度主文件</li>
<li><code>table_remission.py</code>  任务失败重跑调度文件，需要输入执行参数，只支持单域名内重跑<blockquote>
<p>var1 var2 var3 var4….<br>var1:该脚本绝对地址<br>var2:任务域名<br>var3:是否重跑下游任务，false/true<br>var.:中间表文件相对文件名称，空格分隔</p>
</blockquote>
</li>
</ul>
<h3 id="1-1-4-目录说明"><a href="#1-1-4-目录说明" class="headerlink" title="1.1.4 目录说明"></a>1.1.4 目录说明</h3><p>文件夹<code>mid_table_域名</code>为该域名下所有调度所有SQL执行脚本，内可设子目录进行分门别类，便于管理<br>文件夹<code>log_mid_table</code>为日志目录，存储各域的ods数据量(ods_log_<code>域名</code>)、任务调度日志(run_log_<code>域名)、任务重跑日志(rerun_log_</code>域名)，均为Excel文件格式  </p>
<blockquote>
<p><code>调度文件py使用详见py文件内容</code></p>
</blockquote>
<h2 id="1-2-报表展示平台"><a href="#1-2-报表展示平台" class="headerlink" title="1.2 报表展示平台"></a>1.2 报表展示平台</h2><h3 id="1-2-1-简介"><a href="#1-2-1-简介" class="headerlink" title="1.2.1 简介"></a>1.2.1 简介</h3><ul>
<li>准备图表所需数据</li>
<li>按照图表配置进行制图</li>
</ul>
<h3 id="1-2-2-工作目录"><a href="#1-2-2-工作目录" class="headerlink" title="1.2.2 工作目录"></a>1.2.2 工作目录</h3><ul>
<li>本机: /Users/zhangqiang/DATSCI/风控实验室/风控报表  </li>
<li>服务器: /home/mission</li>
</ul>
<h3 id="1-2-3-文件说明"><a href="#1-2-3-文件说明" class="headerlink" title="1.2.3 文件说明"></a>1.2.3 文件说明</h3><ul>
<li><code>data_域名.py</code> 该域内的图表数据准备主文件</li>
<li><code>work_域名.py</code> 该域内的制图主文件</li>
<li><code>report_域名_html_list.xlsx</code>用于记录html文件名，便于次日删除</li>
</ul>
<h3 id="1-2-4-目录说明"><a href="#1-2-4-目录说明" class="headerlink" title="1.2.4 目录说明"></a>1.2.4 目录说明</h3><p>文件夹<code>report_sql_域名</code>为该域名下所有报表所需数据执行SQL文件，需要按照报表类别命名排序<br>文件夹<code>report_data_域名</code>为该域名下报表所需数据的存储目录，按天存储，数据文件名为SQL文件名，均为Excel文件格式<br>文件夹<code>report_file_域名</code>为该域名下所有生成的HTML报表文件</p>
<blockquote>
<p><code>调度文件py使用详见py文件内容</code></p>
</blockquote>
<h1 id="2-代码部署"><a href="#2-代码部署" class="headerlink" title="2.代码部署"></a>2.代码部署</h1><h2 id="2-1-文件上传"><a href="#2-1-文件上传" class="headerlink" title="2.1 文件上传"></a>2.1 文件上传</h2><h3 id="任务调度系统"><a href="#任务调度系统" class="headerlink" title="任务调度系统"></a>任务调度系统</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp -r  &#x2F;Users&#x2F;zhangqiang&#x2F;DATSCI&#x2F;数据实验室&#x2F;数据报表&#x2F;table_mission_risk.py vm1:&#x2F;home&#x2F;mission&#x2F;   </span><br><span class="line">scp -r  &#x2F;Users&#x2F;zhangqiang&#x2F;DATSCI&#x2F;数据实验室&#x2F;数据报表&#x2F;table_remission.py vm1:&#x2F;home&#x2F;mission&#x2F;   </span><br><span class="line">scp -r  &#x2F;Users&#x2F;zhangqiang&#x2F;DATSCI&#x2F;数据实验室&#x2F;数据报表&#x2F;table_mission_atlantis.py vm1:&#x2F;home&#x2F;mission&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="报表展示平台"><a href="#报表展示平台" class="headerlink" title="报表展示平台"></a>报表展示平台</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp -r  &#x2F;Users&#x2F;zhangqiang&#x2F;DATSCI&#x2F;风控实验室&#x2F;风控报表&#x2F;data_risk.py vm1:&#x2F;home&#x2F;mission&#x2F;    </span><br><span class="line">scp -r  &#x2F;Users&#x2F;zhangqiang&#x2F;DATSCI&#x2F;风控实验室&#x2F;风控报表&#x2F;work_risk.py vm1:&#x2F;home&#x2F;mission&#x2F;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-Git同步"><a href="#2-2-Git同步" class="headerlink" title="2.2 Git同步"></a>2.2 Git同步</h2><h3 id="2-2-1-本机同步到gitlab"><a href="#2-2-1-本机同步到gitlab" class="headerlink" title="2.2.1 本机同步到gitlab"></a>2.2.1 本机同步到gitlab</h3><ul>
<li>进入目录<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -u -m &#39;备注&#39;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
目录包含:Python包、中间表SQL、报表SQL     </li>
</ul>
<h3 id="2-2-2-gitlab同步到服务器"><a href="#2-2-2-gitlab同步到服务器" class="headerlink" title="2.2.2 gitlab同步到服务器"></a>2.2.2 gitlab同步到服务器</h3><blockquote>
<p>scp -r  /Users/zhangqiang/DATSCI/风控实验室/风控报表/gits.sh vm1:/home/mission/   </p>
</blockquote>
<p>内容如下  </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/lib64/python3.6/site-packages/report   </span><br><span class="line">git pull --rebase origin master</span><br><span class="line"><span class="built_in">cd</span> /usr/lib64/python3.6/site-packages/tools</span><br><span class="line">git pull --rebase origin master</span><br><span class="line"><span class="built_in">cd</span> /home/mission/mid_table_risk</span><br><span class="line">git pull --rebase origin master</span><br><span class="line"><span class="built_in">cd</span> /home/mission/mid_table_atlantis</span><br><span class="line">git pull --rebase origin master</span><br><span class="line"><span class="built_in">cd</span> /home/mission/report_sql_risk</span><br><span class="line">git pull --rebase origin master</span><br></pre></td></tr></table></figure>
<h2 id="2-3-一次性同步文件"><a href="#2-3-一次性同步文件" class="headerlink" title="2.3 一次性同步文件"></a>2.3 一次性同步文件</h2><p>scp -r  /Users/zhangqiang/DATSCI/风控实验室/风控报表/report_file/echarts.min.js vm1:/usr/share/nginx/html<br>scp -r  /Users/zhangqiang/DATSCI/风控实验室/风控报表/report_file/vintage.js vm1:/usr/share/nginx/html<br>scp -r  /Users/zhangqiang/DATSCI/风控实验室/风控报表/report_file/vintage.js vm1:/usr/share/nginx/html<br>scp -r  /Users/zhangqiang/DATSCI/风控实验室/风控报表/report_file/shine.js vm1:/usr/share/nginx/html<br>scp -r  /Users/zhangqiang/DATSCI/风控实验室/风控报表/report_file/macarons.js vm1:/usr/share/nginx/html</p>
<h1 id="3-定时任务"><a href="#3-定时任务" class="headerlink" title="3.定时任务"></a>3.定时任务</h1><blockquote>
<p>crontab -e   </p>
</blockquote>
<p>内容如下</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">0 4 * * * /home/mission/gits.sh</span><br><span class="line">0 6 * * * python3 /home/mission/table_mission_risk.py</span><br><span class="line">0 8 * * * python3 /home/mission/data_risk.py</span><br><span class="line">30 8 * * * python3 /home/mission/work_risk.py </span><br><span class="line">0 9 * * * python3 /home/mission/table_mission_atlantis.py</span><br></pre></td></tr></table></figure>

<h1 id="4-本地部署"><a href="#4-本地部署" class="headerlink" title="4 本地部署"></a>4 本地部署</h1><h2 id="4-1-本地执行"><a href="#4-1-本地执行" class="headerlink" title="4.1 本地执行"></a>4.1 本地执行</h2><p>python3 /home/mission/table_mission_risk.py<br>python3 /home/mission/data_risk.py<br>python3 /home/mission/work_risk.py<br>python3 /home/mission/table_mission_atlantis.py</p>
<h2 id="4-2-服务器同步至本地"><a href="#4-2-服务器同步至本地" class="headerlink" title="4.2 服务器同步至本地"></a>4.2 服务器同步至本地</h2><p>scp -r   vm1:/home/mission/report_data/2020-05-26  /Users/zhangqiang/DATSCI/风控实验室/风控报表/report_data<br>scp -r   vm1:/home/mission/log/ods_log_2020_05_24.xlsx  /Users/zhangqiang/<br>scp -r   vm1:/home/mission/log/run_log_2020_05_24.xlsx  /Users/zhangqiang/</p>
]]></content>
      <categories>
        <category>编程基础</category>
      </categories>
      <tags>
        <tag>报表</tag>
      </tags>
  </entry>
  <entry>
    <title>文章模板</title>
    <url>/2020/04/10/wen-zhang-mo-ban/</url>
    <content><![CDATA[<p><img src="/2020/04/10/wen-zhang-mo-ban/q.jpg" alt></p>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
]]></content>
      <categories>
        <category>其他</category>
      </categories>
      <tags>
        <tag>标签1</tag>
        <tag>标签2</tag>
      </tags>
  </entry>
  <entry>
    <title>目录大全|金融科技</title>
    <url>/2020/04/16/mu-lu-da-quan-jin-rong-ke-ji/</url>
    <content><![CDATA[<p>目录</p>
<a id="more"></a>

<blockquote>
<p>基础知识储备</p>
</blockquote>
<h2 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h2><h3 id="一、Vintage分析法"><a href="#一、Vintage分析法" class="headerlink" title="一、Vintage分析法"></a>一、Vintage分析法</h3><h3 id="二、迁移率"><a href="#二、迁移率" class="headerlink" title="二、迁移率"></a>二、迁移率</h3><blockquote>
<p>风控模型</p>
</blockquote>
<ul>
<li><input disabled type="checkbox"> dsf </li>
<li><input disabled type="checkbox"> dsf </li>
<li><input disabled type="checkbox"> dsf </li>
</ul>
<blockquote>
<p>反欺诈</p>
</blockquote>
<ul>
<li><input disabled type="checkbox"> sdf </li>
</ul>
<blockquote>
<p>风控策略</p>
</blockquote>
<ul>
<li><input checked disabled type="checkbox"> sdf </li>
<li><input disabled type="checkbox"> dsf </li>
<li><input disabled type="checkbox"> dsf </li>
</ul>
]]></content>
      <categories>
        <category>金融科技</category>
      </categories>
  </entry>
</search>
